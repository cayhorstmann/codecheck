<?xml version="1.0" encoding="ISO-8859-1"?>
<!--

    Copyright 2006-2012 Cay S. Horstmann

    This file is part of Codecheck.

    Codecheck is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Codecheck is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Codecheck.  If not, see <http://www.gnu.org/licenses/>.

-->

<project name="CodecheckRule" basedir=".">

  <property name="src.dir" value="${basedir}/src" />
  <property name="build.dir" value="${basedir}/antbuild" />
  <property name="lib.dir" value="${basedir}/lib" />
  <property name="jarfile" value="${ant.project.name}.jar" />
  <property name="runnerfile" value="run${ant.project.name}.jar" />
  <property name="app.resources" 
             value="${src.dir}/com/horstmann/codecheck/codecheck.properties" />

  <path id="classpath">
    <fileset dir="${lib.dir}" includes="**/*.jar" />
  </path>   
  
  <target name="clean" description="Delete all generated files">
    <delete dir="${build.dir}" />
  </target>

  <target name="init">
    <mkdir dir="${build.dir}" />
    <tstamp>
       <format property="VERSION"
               pattern="yyMMddHHmm"/>
    </tstamp>
  </target>

  <target name="props" depends="init" description="Set version-specific properties.">
    <replaceregexp file="${app.resources}" byline="true">
       <regexp pattern="(version\s*=\s*).*"/>
       <substitution expression="\1${VERSION}"/>
    </replaceregexp>
 </target>

  <target name="compile" description="Compiles the Task" depends="init, props">
    <javac includeantruntime="false" srcdir="${src.dir}" debug="true" destdir="${build.dir}" />
    <copy todir="${build.dir}" preservelastmodified="true">
      <fileset dir="${src.dir}">
        <include name="**/*.xml" />
        <include name="**/*.properties" />
      </fileset>
    </copy>
  </target>
  
  <target name="jar" description="Makes the JAR file" depends="compile">
    <jar destfile="${jarfile}" basedir="${build.dir}">
    </jar>
  </target>

</project>
